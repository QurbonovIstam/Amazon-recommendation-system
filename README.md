Гибридная рекомендательная система для отзывов на товары Amazon
Этот проект представляет собой пошаговое исследование и разработку рекомендательной системы для товаров Amazon. Цель — предсказать следующий товар, который может купить пользователь, на основе его предыдущих оценок. В ходе проекта были построены и оценены три различные модели: чистая коллаборативная фильтрация и две гибридные модели с текстовым переранжированием.

Набор данных
Контекст
Этот набор данных содержит более 568 тысяч отзывов потребителей о различных товарах Amazon. Этот набор данных также доступен на других сайтах, связанных с этими наборами данных, но я счёл его полезным и поделился им здесь.

Содержание
Этот набор данных содержит следующие атрибуты:

Всего записей: 568454
Всего столбцов: 10
Доменное имя: amazon.com
Расширение файла: CSV
Доступные поля: Id, ProductId, UserId, ProfileName, HelpfulnessNumerator, HelpfulnessDenomenator, Score, Time, Summary, Text
Используется публичный датасет Amazon Product Reviews с платформы Kaggle.

Предварительная обработка:

Данные были загружены и проанализированы на предмет пропусков.
Для построения надежных рекомендаций были отобраны только пользователи, оставившие 5 и более отзывов.
Данные были разделены на обучающую (train_df) и тестовую (test_df) выборки по принципу "Leave-One-Out": последняя по времени покупка каждого пользователя попала в тест, а все предыдущие — в обучение.
Построенные модели
Модель 1: Коллаборативная фильтрация (ALS)
В качестве базовой модели была использована коллаборативная фильтрация на основе метода Alternating Least Squares (ALS) из библиотеки implicit.

Подбор гиперпараметров: С помощью поиска по сетке (Grid Search) были найдены оптимальные параметры для модели: factors=100, regularization=0.01, iterations=25.
Качество: Модель показала очень хороший базовый результат.
Модель 2: Гибридная модель (ALS + TF-IDF на Summary)
Первая попытка улучшить базовую модель заключалась в добавлении контентной логики. Идея была в том, чтобы переранжировать топ-20 кандидатов от ALS, используя текстовую схожесть на основе кратких описаний (Summary).

Метод: Для каждого пользователя вычислялся средний TF-IDF вектор его истории покупок. Затем 20 кандидатов от ALS сортировались по косинусному сходству с этим вектором.
Результат: Эта модель показала значительное ухудшение качества по сравнению с базовой. Вывод: краткие описания Summary слишком зашумлены и не несут достаточной информации для качественного переранжирования.
Модель 3: Улучшенная гибридная модель (ALS + TF-IDF на Text)
Основываясь на выводах предыдущего шага, была построена вторая гибридная модель, но на этот раз TF-IDF векторы создавались на основе полных текстов отзывов (Text).

Метод: Логика переранжирования осталась той же, но использовалась новая, более подробная TF-IDF матрица.
Результат: Эта модель показала улучшение по сравнению с чистой ALS. Это доказывает, что при достаточном количестве качественной текстовой информации контентное переаранжированные способно улучшить результаты коллаборативной фильтрации.Итоговые результаты
Производительность всех моделей оценивалась по метрике Hit@10 (доля пользователей, для которых правильный товар попал в топ-10 рекомендаций).

Модель	Описание	Hit@10
Original ALS	Коллаборативная фильтрация	0.4542
Hybrid (Summary)	ALS + TF-IDF на кратких описаниях	0.2408
Hybrid (Full Text)	ALS + TF-IDF на полных текстах	0.4667
Выводы и дальнейшие шаги
Чистая коллаборативная фильтрация (ALS) является очень сильной базовой моделью. Однако ее можно улучшить с помощью гибридного подхода, если использовать качественные контентные данные. Полные тексты отзывов, в отличие от кратких summary, содержат достаточно сигнала для эффективного переранжирования.

Возможные дальнейшие шаги:

Использовать BERT: Применить более продвинутые языковые модели (BERT, RoBERTa) для создания семантических эмбеддингов текста, что может дать еще больший прирост качества.
Настройка гибридной модели: Экспериментировать с размером окна кандидатов от ALS (например, брать топ-50 или топ-100) и весами, с которыми смешиваются оценки от ALS и контентной модели.
